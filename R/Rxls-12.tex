%% LaTeX2e file `R/Rxls-12.Rnw'
%% generated by the `Rnw' environment
%% from source `Rxls' on 2015/09/05.
%%
\begin{kframe}
\noindent{\color{srccolor}> cat(readLines("calc.R"), sep = "\textbackslash{}n")}
\noindent{\color{outcolor}calc.cn<-function(lx,}
\noindent{\color{outcolor}                  nu=1/(1+i),}
\noindent{\color{outcolor}                  i=if (!missing (nu)) (1/nu)-1)\{}
\noindent{\color{outcolor}  x <- seq\_along(lx)-1}
\noindent{\color{outcolor}  \#\# 0-val indul az indexelés}
\noindent{\color{outcolor}  lx1<- lx[-length(lx)]}
\noindent{\color{outcolor}  qx <- -0.95*diff(lx)/(lx1+(lx1==0))}
\noindent{\color{outcolor}  \#\# módosított halandóság}
\noindent{\color{outcolor}  lx <- lx[1]*cumprod(c(1,1-qx))}
\noindent{\color{outcolor}  \#\# módosított l}
\noindent{\color{outcolor}  df <- data.frame(x=x,lx=lx,qx=c(qx,1),Dx=lx*nu\textasciicircum{}x)}
\noindent{\color{outcolor}  df\$dx <- with(df,lx*qx)}
\noindent{\color{outcolor}  df\$Cx <- with(df,dx*nu\textasciicircum{}(x+.5))}
\noindent{\color{outcolor}  df\$Nx <- rev(cumsum(rev(df\$Dx)))}
\noindent{\color{outcolor}  df\$Mx <- rev(cumsum(rev(df\$Cx)))}
\noindent{\color{outcolor}  df\$Rx <- rev(cumsum(rev(df\$Mx)))}
\noindent{\color{outcolor}  attr(df,"nu")<-nu}
\noindent{\color{outcolor}  attr(df,"i")<-i}
\noindent{\color{outcolor}  df}
\noindent{\color{outcolor}\}}
\noindent{\color{outcolor}\#\# teszt adat}
\noindent{\color{outcolor}lx<-seq(1e5,0,length.out=101)}
\noindent{\color{outcolor}cn<-calc.cn(lx,i=.05)}
\end{kframe}
